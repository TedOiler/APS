X2 <- sum((O-E)^2/E)
df <- (nrow(O)-1)*(ncol(O)-1)
p <- 1 - pchisq(X2,df = df)
chisq.test(O)
?rbin
rbin?
help(rbin)
help(bin)
??bin
?dbinom
knitr::opts_chunk$set(echo = TRUE)
require(rjags)
knitr::opts_chunk$set(echo = TRUE)
require(rjags)
set.seed(1903)
n=15; N=20; theta=0.75; y=rbinom(n, N,theta); a0=9.2; b0=13.8
# Model
model_string <- "model{
# Likelihood
for (i in 1:n){
y[i]~dbinom(theta)
}
#Prior for theta
theta~dbeta(a0,b0)
}"
# Specifications
data = list(y=y, n=n, a0=a0, b0=b0)
chains = 1
# inits=list(list(a,b), list(a,b), list(a,b))
# Model instansiation
model = jags.model(textConnection(model_string),n.chains=chains,data=data)
?dbinom
knitr::opts_chunk$set(echo = TRUE)
require(rjags)
require('coda')
require('rjags')
require('ggmcmc')
ms = '
model {
theta ~ dunif(0, 1)
k ~ dbinom(theta, N)
}
'
params = c('theta')
data = list('k' = 7, 'N' = 10)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
samples = coda.samples(model, variable.names = params, n.iter = 10000)
require('coda')
require('rjags')
require('ggmcmc')
ms = '
model {
k ~ dbinom(theta, N)
theta ~ dunif(0, 1)
}
'
params = c('theta')
data = list('k' = 7, 'N' = 10)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
samples = coda.samples(model, variable.names = params, n.iter = 10000)
require('coda')
require('rjags')
require('ggmcmc')
ms = '
model {
k ~ dbinom(theta, N)
theta ~ dbeta(9.2, 13.8)
}
'
params = c('theta')
data = list('k' = 7, 'N' = 10)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
samples = coda.samples(model, variable.names = params, n.iter = 10000)
require('coda')
require('rjags')
require('ggmcmc')
ms = '
model {
k ~ dbinom(theta, N)
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k' = 7, 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
samples = coda.samples(model, variable.names = params, n.iter = 10000)
set.seed(1903)
n=15; N=20; theta=0.75; y=rbinom(n, N,theta); a0=9.2; b0=13.8
y
# Model
model_string <- "model{
# Likelihood
for (i in 1:N){
y[i]~dbinom(n,theta)
}
#Prior for theta
theta~dbeta(a0,b0)
}"
# Specifications
data = list(y=y, n=n, a0=a0, b0=b0)
chains = 1
# inits=list(list(a,b), list(a,b), list(a,b))
# Model instansiation
# model = jags.model(textConnection(model_string),n.chains=chains,data=data)
# res = coda.samples(model, variable.names = c('theta'), n.iter=1000)
# summary(res)
set.seed(1903)
n=15; N=20; theta=0.75; y=rbinom(n, N,theta); a0=9.2; b0=13.8
y
# Model
model_string <- "model{
# Likelihood
for (i in 1:N){
y[i]~dbinom(n,theta)
}
#Prior for theta
theta~dbeta(a0,b0)
}"
# Specifications
data = list(y=y, n=n, a0=a0, b0=b0)
chains = 1
# inits=list(list(a,b), list(a,b), list(a,b))
# Model instansiation
# model = jags.model(textConnection(model_string),n.chains=chains,data=data)
# res = coda.samples(model, variable.names = c('theta'), n.iter=1000)
# summary(res)
set.seed(1903)
n=15; N=20; theta=0.75; y=rbinom(n, N,theta); a0=9.2; b0=13.8
y
# Model
model_string <- "model{
# Likelihood
for (i in 1:N){
y[i]~dbinom(n,theta)
}
#Prior for theta
theta~dbeta(a0,b0)
}"
# Specifications
data = list(y=y, n=n, a0=a0, b0=b0)
chains = 1
# inits=list(list(a,b), list(a,b), list(a,b))
# Model instansiation
# model = jags.model(textConnection(model_string),n.chains=chains,data=data)
# res = coda.samples(model, variable.names = c('theta'), n.iter=1000)
# summary(res)
set.seed(1903)
n=15; N=20; theta=0.75; y=rbinom(n, N,theta); a0=9.2; b0=13.8
y
# Model
model_string <- "model{
# Likelihood
for (i in 1:N){
y[i]~dbinom(n,theta)
}
#Prior for theta
theta~dbeta(a0,b0)
}"
# Specifications
data = list(y=y, n=n, a0=a0, b0=b0)
chains = 1
# inits=list(list(a,b), list(a,b), list(a,b))
# Model instansiation
# model = jags.model(textConnection(model_string),n.chains=chains,data=data)
# res = coda.samples(model, variable.names = c('theta'), n.iter=1000)
# summary(res)
knitr::opts_chunk$set(echo = TRUE)
require(rjags)
require(coda)
require(ggmcmc)
set.seed(1903)
ms = '
model {
k[i] ~ dbinom(theta, N)
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = rbinom(15, 20,0.75), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
set.seed(1903)
ms = '
model {
k ~ dbinom(theta, N)
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k' = rbinom(15, 20,0.75), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
set.seed(1903)
ms = '
model {
k ~ dbinom(theta, N)
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
samples = coda.samples(model, variable.names = params, n.iter = 10000)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
summary(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
par(mfrow=c(1,2))
res = coda.samples(model, variable.names = params, n.iter = 10000)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
par(mfrow=c(1,2))
res = coda.samples(model, variable.names = params, n.iter = 10000)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
par(mfrow=c(2,1))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE, quite=TRUE)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000)
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, progress.bar="none")
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k' = c(rbinom(15, 20,0.75)), 'N' = 10, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 20, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 20, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
summary(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 100000, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
summary(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 100000, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
gelman.plot(res)
set.seed(1903)
ms = '
model {
for (i in 1:N){
k[i] ~ dbinom(theta, N)
}
theta ~ dbeta(a0, b0)
}
'
params = c('theta')
data = list('k[i]' = c(rbinom(15, 20,0.75)), 'N' = 100000, 'a0'= 9.2, 'b0'=13.8)
model = jags.model(textConnection(ms), data = data,
n.chains = 3, n.adapt = 1000, quiet = TRUE)
res = coda.samples(model, variable.names = params, n.iter = 10000, progress.bar="none")
par(mfrow=c(1,2))
summary(res)
install.packages("Stat2Data", lib="/kaggle/working")
install.packages("Stat2Data")
View(samples)
