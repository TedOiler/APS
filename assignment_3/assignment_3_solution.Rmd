---
title: "Assignment 3"
author: "Ted Ladas - s2124289"
date: "12/03/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Reaction times were recorded for 13 individuals under the influence of either drug A or drug B, giving the following data:

-   Drug A: 2.07 1.71 2.24 1.62 2.11
-   Drug B: 2.41 1.96 1.93 2.71 2.50 2.84 2.88 2.43

## a) Use \textsf{R} to carry out a Mann-Whitney U-test on these data.

```{r a}
rm(list = ls())
drug.a <- c(2.07, 1.71, 2.24, 1.62, 2.11)
drug.b <- c(2.41, 1.96, 1.93, 2.71, 2.50, 2.84, 2.88, 2.43)

wilcox.test(drug.a, drug.b, alternative='two.sided', exact=TRUE)
```

Suppose $drug.a$ is a random sample from the random variable $X$, while $drug.b$ is a random sample from the random variable $Y$.

$H_0: X, Y ~~ \text{have the same distribution}$

$H_1: X, Y ~~ \text{don't have the same distribution}$

The assumptions for this test are:

1.   $X$ and $Y$ are independent -which is true since the are different patients.
2.  The observations are at least ordinal -which is true since the data are times, and therefore continuous ratio data.

Our data have no ties in them, therefore the *p-value* calculated is exact and does not rely on a Normal approximation. Since the *p-value* of the test is $0.04507$, that means that we **reject** the null hypothesis on $\alpha = 5\%$ significance level. Therefore, the random variables **do not have** the same distribution.

\newpage

## b) Use \textsf{R} to carry out a two-sample randomisation test, based on sample means, to assess whether the effects of the two drugs differ, and state your conclusions.

```{r b, out.width="60%"}
set.seed(1903)
n <- length(drug.a)
m <- length(drug.b)
z <- c(drug.a, drug.b)
T.obs <- mean(drug.a) - mean(drug.b)
B <- 1e3
T.s <- NULL

for(b in 1:B){
  s <- sample(1:(n+m), n, replace=FALSE)
  T.sample <- mean(z[s]) - mean(z[-s])
  T.s <- c(T.s, T.sample)
}

T.s <- c(T.s, T.obs)
hist(T.s)
abline(v=mean(T.obs), col='red4', lwd=2)

pvalue.right <- mean(T.s >= T.obs)
pvalue.left <- mean(T.s <= T.obs)

pvalue.twosided <- 2*min(pvalue.right, pvalue.left)
print('Randomization test approximate p-value:', pvalue.twosided)
```

According to the two-sample randomization test based on the sample means, the *p-value* is $0.009$, and it was calculate for $1000$ iterations. This is significant on the $\alpha = 5\%$ significance level, which means that we **reject** the null hypothesis. Therefore the two random variables **do not have** the same mean.

\newpage

## c) Will the *p-value* calculated in part (b) differ to one calculated by enumerating all permutations at least as extreme as the observed one? Explain your answer

The *p-value* of the randomization test will be different from the one calculated by enumerating all the permutations. This is because all the permutations are `choose(n+m,n) = choose(13,8) = 1287` which is bigger than our `B=1000` . Therefore, some permutation are not checked on the randomization test. The final result though wouldn't be that different and since our *p-value* is much less than $5\%$, it makes sense to not explore the full permutation test.
